# note
所学
## linux学习笔记
**网络连接的三种模式**

1. 桥接模式

   虚拟系统可以和外部通讯，但是在同一网段下，容易造成IP冲突

2. nat模式

   网络地址转换模式，虚拟系统可以和外部通讯，不造成IP冲突，平时一般用nat模式

3. 主机模式

   一个独立的主机，不联网

**虚拟机克隆**

1. 直接拷贝一份安装好的虚拟机文件

2. 使用VMware的克隆操作

   tips：克隆需要先关闭Linux系统

**虚拟机快照**

​	可以回到虚拟机的某个状态，建议在进行重要操作前保存快照

**vmtools**

1. 打开虚拟机
2. 点击vm菜单的安装vmtools
3. 在Linux系统里会出现一个安装包，拷贝到/opt 下
4. 使用解压命令tar，得到安装文件，进入解压的目录，在/opt 下，安装 ./vmware-install.pl
5. 全部默认设置，安装vmtools需要有gcc

**Linux目录结构**

1. 树状结构，在Linux中一切皆文件
2. 根目录下文件夹名不能改，Linux增加的硬盘通过挂载的方式挂在某个目录下
3. /bin 存放经常使用的命令
4. /sbin 存放系统管理员使用的系统管理程序
5. /home 存放普通用户的主目录，linux中每个用户都有一个自己的目录，一般目录名为用户的账户名
6. /root 为系统管理员的用户主目录
7. /lib 系统开机所需要的基本的动态链接共享库，作用类似于Windows下的dll文件
8. /lost+found目录一般情况下是空的，当系统非法关机后，这里就存放了一些文件
9. /etc 所用的系统管理所需要的配置文件和子目录
10. /usr 用户的很多应用程序和文件在此目录，相当于Windows下的program files文件夹
11. /boot 存放启动Linux时的一些核心文件，包括一些连接文件和镜像文件
12. /proc 这个目录是一个虚拟的目录，它是系统内存的映射，访问这个目录来获取系统信息
13. /srv   service的缩写，该目录存放一些服务器启动之后需要提取的数据
14. /sys  这是Linux2.6内核的一个很大的变化，该目录下安装了2.6内核中新出现的一个文件系统sysfs
15. /tmp 存放临时文件
16. /dev 类似于Windows的设备管理器，把所有的硬件用文件的形式储存
17. /media linux会自动识别一些设备如U盘，光驱等，识别后Linux会把识别的设备挂载到这个目录下
18. /mnt 让用户临时挂载别的文件系统的，可以将外部的存储挂载在/mnt上，如共享文件夹
19. /opt 给主机额外安装软件所摆放的目录，默认为空
20. /usr/local 这是另一个给主机额外安装软件所安装的目录，一般是通过编译源码方式安装的程序
21. /var 这个目录中存放着不断扩充的东西，习惯将进场被修改的目录放在这个目录下，包括各种日志文件
22. /selinux  SElinux是一种安全子系统，它能控制程序只能访问特定文件，有三种工作模式，可自行设置

**远程登陆和远程传输文件**

​	主要使用xshell和xftp，Linux终端下输入ifconfig指令查看IP，Windows终端下ping IP测试是否可以连接

**vi和vim简单操作**

1. 常用的三种模式

   - 正常模式

     以vim打开一个文档直接进入一般模式，该模式下可以移动光标，可以进行删除字符，删除整行等操作，可以复制，粘贴处理文件数据

   - 插入模式

     正常模式下按下i,I,o,O,a,A,r,R等任何一个字母之后进入插入模式，按下esc键返回正常模式

   - 命令行模式

     正常模式下输入  ： 进入命令行模式，按下esc键返回正常模式

     可以输入相关指令，完成读取，储存，替换，离开vim，显示行号等操作

2. 常用指令

   - vim xxx    终端下输入vim加空格加文件名，以vim打开该文档
   - wq    保存并退出
   - q   退出
   - q！  强制退出不保存
   - yy 拷贝当前行，5yy 拷贝当前行向下的5行，p  粘贴
   - dd  删除当前行，5dd  删除当前行向下5行，d 再输入退格  删除光标选中的字母
   - 正常模式下输入   / 关键字  回车   查找该关键字，输入n查找下一个
   - 命令行模式下set nu  显示文件行号，set nonu 取消文件行号
   -  G  到达文档最末行，gg  到达文档首行
   - u  撤销上一个动作
   -  nG   将光标移动到第n行
   -  **关机&重启**

1. shutdown -h now   立刻进行关机
2. shutdown -h 1   一分钟后关机，shutdown  -h  默认是一分钟后关机
3. halt  关机，同上
4. shutdown -r now  立刻重启计算机
5. reboot 立刻重启计算机
6. sync 把内存的数据同步到磁盘，现在的关机命令都会在执行关机前执行此步，为了保险，建议手动执行此步

**运行级别**

0. 关机
1. 单用户(找回丢失密码)
2. 多用户状态没有网络连接
3. 多用户状态有网络连接
4. 系统未使用保留给用户
5. 图形界面
6. 系统重启

​	init 0-6    切换运行级别

**用户**

1. 尽量少用root登陆，普通用户登录后再用  su - root 切换管理员

2. logout 退出当前用户，只在运行级别3下有效

3. useradd 用户名     新建一个用户

4. useradd -d 指定目录 用户名       新建一个用户，指定其用户的目录

5. password 用户名   修改指定用户密码

6. pwd  显示当前用户所在目录

7. userdel 用户名   删除指定用户，不删除用户文件夹

8. userdel -r 用户名   删除指定用户，同时删除用户文件夹

9. id 用户名  查询用户信息

10. su - 用户名   切换用户，切换到高权限需要输入密码，反之不需要

11. whoami/who am i   查询当前登录用户信息/查询首次登陆用户信息

12. groupadd 组名  新建用户组

13. groupdel 组名  删除用户组

14. useradd -g 用户组 用户名  新建用户时直接加入组，未指定用户组时会生成一个和用户名相同的组将用户加入

15. usermod -g 用户组 用户名   修改用户的组

16. /etc/passed 文件：user的配置文件，记录用户的各种信息

    每行含义：用户名口令；用户标识号；组标识号；注释性描述；主目录；登录shell

17. /etc/shadow 文件：口令的配置文件

    每行含义：登录名；加密口令；最后一次修改时间；最小时间间隔；最大时间间隔；警告时间；不活动时间；失效时间；标志

18. /etc/group 组的配置文件，记录Linux包含的组的信息

    每行含义：组名；口令；组标识号；组内用户列表

**帮助指令**

- man [命令或配置文件]   获得帮助信息
- help [命令]   获得shell内置命令的帮助信息

**文件目录命令**

1. pwd 显示当前工作目录的绝对路径

2. ls 显示当前目录内所有文件和信息

   -a：显示所有文件和信息，包括隐藏的

   -l：以列表的方式显示信息

3. cd 切换到指定目录

   cd ~或cd ：回到自己的家目录

   cd .. 回到当前目录的上一级目录

4. mkdir 创建目录

   -p：创建多级目录

5. rmdir 删除空目录

6. rm -rf 删除非空目录

7. touch 创建指定空文件

8. cp [选项] 文件 拷贝的地方     将文件拷贝到指定目录

   -r：递归复制整个文件夹，拷贝文件夹用这个

   \cp：强制覆盖文件，不接受是否覆盖的提示

9. rm [选项] 要删除的文件或目录

   -r：递归删除整个文件夹

   -f：强制删除不提示

10. mv oldNameFile newNameFile   重命名

    mv 文件所在位置   另一个位置     移动文件

11. cat [选项] 要查看的文件

    -n：显示行号

    cat只能浏览文件，不能修改文件，为了浏览方便一般会带上 管道命令 | more

    管道符号 | ：表示将其哪一个命令的处理结构输出传递给后面的命令处理

12. more指令是一个基于vi编辑器的文本过滤器，以全屏幕的方式按页显示文本文件的内容，快捷键如下：

    空格space：向下翻一页

    Enter：向下翻一行

    q：离开more

    ctrl+f：向下滚动一页

    ctrl+b：返回上一屏

    =：输出当前行的行号

    :f   ：输出文件名和当前行号

13. less指令用分屏查看文件内容，功能与more指令类似，但比more更强大，支持各种终端，less在显示文件内容时，并不是一次将整个文件加载之后才显示，而是根据显示需要加载内容，对于显示大型文件有较高效率

    space：向下翻一页

    pagedown：向下翻一页

    pageup：向上翻一页

    /字串：向下搜寻(字串)，n：向下查找；N：向上查找

    ？字串：向上搜寻(字串)，n：向上查找；N：向下查找

    q：离开less

14. echo 输出内容到控制台

    echo [选项] [内容]

15. head 用于显示文件开头的部分内容，head默认显示文件的前10行内容

    head -n 5：查看文件头五行内容

16. tail 输出文件中尾部的内容，默认输出文件的尾10行内容

    tail -n 5：查看文件尾5行内容

    tail -f 文件：实时追踪文档的所有更新

17. 指令>：输出重定向

    指令>>：追加

    ls -l > 文件             将列表的内容写入文件(覆盖写)

    ls -al >> 文件            将列表的内容追加到文件的末尾

    cat 文件1 > 文件2     将文件1的内容覆盖到文件2

    echo 内容 >> 文件    将内容追加到文件末尾

18. ln指令：软链接，也叫符号链接，类似于Windows下的快捷方式，主要存放了链接其他文件的路径

    ln -s [文件或目录] [软链接名]           给文件或目录创建一个软链接

    tips：当使用pwd指令查看目录时仍然看到的是软链接所在目录

19. history     查看已执行过的历史指令

    history 10   查看最近十条指令

    !7          执行第七条指令

**时间日期**

1. date   显示当前时间

   date +%Y    显示当前年份

   date +%m    显示当前月份

   date +%d   显示当前是哪一天

   date "+%Y-%m-%d %H:%M:%S"           显示年月日时分秒

   date -s "字符串时间"         设置系统当前时间

2. cal     显示本月日历

   cal 2022   显示2022年日历

**搜索查找**

1. find [搜索范围] [选项]

   -name：安装指定文件名查找文件

   -user：查找属于用户名的所有文件

   -size：安装指定的文件大小查找文件   +n大于   -n小于  n等于，数字后面跟文件大小单位       +200M大于两百M的文件，-200k小于两百k的文件

2. locate可快速定位文件位置，第一次运行前必须使用updatedb指令创建locate数据库，为了保证查询结果准确性，必须定期更新locate

   locate  文件名     查找文件所在位置

3. which  查看某个指令在哪个目录下

4. grep 过滤查找，找到文件中的某个关键字，常搭配 | 使用

   grep [选项] 查找内容 源文件

   -n：显示匹配及行号

   -i：忽略字母大小写
   **压缩和解压**

1. gzip 文件       压缩文件，只能嫁给你文件压缩为*.gz文件

2. gunzip 文件.gz     解压缩文件命令

3. zip [选项] xxx.zip 压缩内容                压缩文件和目录的命令

   -r：递归压缩，即压缩目录

4. unzip [选项] xxx.zip            解压缩文件

   -d [目录]：指定解压后文件的存放目录

5. tar指令是打包指令，打包后文件为.tar.gz文件

   tar [选项] xxx.tar.gz 打包的内容          打包目录，压缩后的文件格式.tar.gz

   -c：产生.tar打包文件

   -v：显示详细信息

   -f：指定压缩后的文件名

   -z：打包同时压缩

   -x：解包.tar文件

   tar -zxvf 解压的文件.tar.gz -C 指定的解压目录                解压到指定目录

**组管理和权限管理**

1. 在Linux中每个用户都必须属于一个组，每个文件有三个概念，这个文件的所有者是谁，一般来说所有者就是创建这个文件的人；这个文件属于哪个组，这个组内对这个文件有一定权限；对于文件所在组以外的其他组，就是该文件的其它组，对该文件也有一定权限

2. ls -ahl     查看文件的所有者/所在组

3. chown 用户名 文件/目录              修改文件/目录所有者

   chown 用户名：组名 文件/目录        改变所有者和所在组

   -R：如果是目录，则使其下所有子文件或目录递归生效

4. chgrp 组名 文件名                    修改文件所在组

   -R：如果是目录，则使其下所有子文件或目录递归生效

5. usermod -g 新组名 用户名        修改用户所在组

6. usermod -d 目录名 用户名      改变该用户登录的 初始目录

7. ls -l  所显示的目录中

   如 -rwxrw-r-- 1 root root 12123 Feb 2 09：39 abc

   前十位说明：

   + 第0位确定文件类型(d,-,l,c,b)，

     l 为链接，相当于Windows的快捷方式

     -为普通文件

     d 是目录，相当于windows的文件夹

     c是字符设备文件，如鼠标，键盘

     b是块设备，如硬盘

   + 第1-3位确定该文件的所有者拥有该文件的权限  --user

   + 4-6位确定所属组拥有该文件的权限   --group

   + 7-9位确定其他用户拥有该文件的权限   --other

   + r：可读；w：可写；x：可执行；-：无；可用数字表示r=4；w=2；x=1；rwx=4+2+1=7

   对该文件有写权限不一定对该文件有删除的权限，删除需要有对该文件所在目录有写权限

   其它说明：

   ​	1：文件硬链接数   或目录的子目录数加上文件数   ；     如果是普通文件这里为1

   ​	root：用户

   ​	root：组

   ​	1213：文件大小（字节），如果是文件夹显示4096字节

   ​	Feb 2 09：39    ：最后修改日期

   ​	abc ：文件名

8. chmod修改文件或目录权限

   + ​       +，-，=变更权限

     u：所有者；g：所有组；o：其他人；a：所有人(u，g，o的总和)

     + chmod u=rwx,g=rx,o=x 文件/目录名            给文件/目录的user/group/other赋予读/写/执行的权限
     + chmod o+w 文件/目录名           给文件/目录的user/group/other增加读/写/执行的权限
     + chmod a-x 文件/目录名              删除文件/目录的user/group/other读/写/执行的权限

